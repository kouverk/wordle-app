<mat-sidenav-container class="sidenav-container">
  <!-- Main Sidenav (left) -->
  <mat-sidenav #sidenav mode="over" [(opened)]="opened" (closedStart)="closeExpansionPanel()" class="sidenav" (click)="!isLoggedIn ? closeSidenav() : ''">
    <mat-nav-list>
      <!-- Multi-Player Expansion Panel with reference variable -->
      <mat-expansion-panel [disabled]="!isLoggedIn">
        <mat-expansion-panel-header>
          <mat-panel-title class="sidenav-title">
            <span class="material-symbols-outlined" style="margin-right:10px">robot</span>
            multi-player games
          </mat-panel-title>
        </mat-expansion-panel-header>
        <!-- User List -->
        <div *ngFor="let user of users" (click)="startGameWithUser(user)" class="user-item">
          <mat-list-item>
            <img [src]="user?.avatar_url" alt="avatar" class="user-avatar" />
            <span class="username">{{ user?.username }}</span>
          </mat-list-item>
        </div>
      </mat-expansion-panel>
      <mat-divider></mat-divider>
      <!-- Single Player Div (Styled like Accordion) -->
      <div class="sidenav-title single-player" [ngClass]="{'disabled': !isLoggedIn}" (click)="isLoggedIn ? startSinglePlayer() : null">
        <span class="material-symbols-outlined" style="margin-right:10px">robot_2</span>
        single player
      </div>
    </mat-nav-list>

    <div class="logout-button" [ngClass]="{'disabled': !isLoggedIn}" (click)="isLoggedIn ? logout() : null">
      <span>Logout</span>
      <mat-icon>logout</mat-icon>
    </div>
  </mat-sidenav>

  <!-- Info Sidenav (right) - Boycott NYT info panel -->
  <mat-sidenav #infoSidenav mode="over" position="end" class="info-sidenav">
    <div class="info-panel">
      <button mat-icon-button class="close-info" (click)="infoSidenav.close()" (touchend)="infoSidenav.close()">
        <mat-icon>arrow_forward_ios</mat-icon>
      </button>

      <div class="info-content">
        <h2>Why This App Exists</h2>

        <p class="intro">
          This app is part of the boycott of The New York Times, offering an alternative for those who want to play Wordle without supporting its Crimes.
        </p>

        <div class="quote-block">
          <p>"Language makes genocide justifiable. A reason why we are still being bombed after 243 days is because of The New York Times and most Western media"</p>
          <span class="attribution">— Hossam Shabat, Palestinian journalist</span>
        </div>

        <p>
          American news media has been critical to maintaining Israel's death machine in gaza. And there is no American media institution more influential than The New York Times.
        </p>
        <p>
          The new york times has routinely collaborated with Israel, printed outright lies from Israeli officials, it has directed reporters to avoid terms like "slaughter" and "ethnic cleansing", and systematically evades the culpability of Israel. 
        </p>
<!--         
        <div class="quote-block">
          <p>"The failure was not individual, but institutional."</p>
          <span class="attribution">— NYT's own accounting of Iraq coverage</span>
        </div> -->

        <a href="https://www.boycottdivestunsubscribe.com/" target="_blank" rel="noopener" class="learn-more">
          Learn More at BoycottDivestUnsubscribe.com
        </a>
      </div>
    </div>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content>
    <!-- In-app browser warning banner -->
    <div class="in-app-warning" *ngIf="isInAppBrowser">
      <span>For the best experience, open in Safari/Chrome. Tap <strong>⋯</strong> then <strong>"Open in Browser"</strong> — it might break if you don't!</span>
      <button mat-icon-button (click)="dismissInAppWarning()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!-- Toolbar -->
    <mat-toolbar>
      <button mat-icon-button class="hamburger" (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>
      <span class="game-label" *ngIf="gameLabel && isLoggedIn">{{ gameLabel }}</span>
      <span class="spacer"></span>
      <!-- Scoreboard dropdown for multiplayer -->
      <button mat-icon-button [matMenuTriggerFor]="scoreMenu" *ngIf="isMultiplayer" class="scoreboard">
        <mat-icon>leaderboard</mat-icon>
      </button>
      <mat-menu #scoreMenu="matMenu" class="score-menu">
        <div class="score-dropdown">
          <div class="score-row">
            <span class="player-name">{{ player1Username }}</span>
            <span class="score" [ngClass]="{'score-high': player1Score > player2Score, 'score-low': player1Score < player2Score, 'score-tied': player1Score === player2Score}">{{ player1Score }}</span>
          </div>
          <div class="score-row">
            <span class="player-name">{{ player2Username }}</span>
            <span class="score" [ngClass]="{'score-high': player2Score > player1Score, 'score-low': player2Score < player1Score, 'score-tied': player1Score === player2Score}">{{ player2Score }}</span>
          </div>
        </div>
      </mat-menu>
      <button mat-icon-button class="heart" (click)="showAffirmation()" *ngIf="isLoggedIn">
        <mat-icon>favorite</mat-icon>
      </button>
      <button mat-icon-button class="theme-toggle" (click)="toggleDarkMode()" *ngIf="isLoggedIn">
        <span class="material-symbols-outlined">{{ isDarkMode ? 'lightbulb' : 'light_off' }}</span>
      </button>
      <button mat-icon-button class="solidarity" (click)="infoSidenav.toggle()">
        <mat-icon>campaign</mat-icon>
      </button>
    </mat-toolbar>

    <!-- Main content of the app -->
    <div class="content">
      <router-outlet></router-outlet>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>